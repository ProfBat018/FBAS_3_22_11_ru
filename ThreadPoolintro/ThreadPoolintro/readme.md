# Тема урока: ThreadPool 

Мы уже с вами прошли Thread. Стоит понять, что мы с вамми идем с низкого уровн к высокому уровню и с каждым 
разом будет подниматься на более простые инстурменты для ревализаци параллелзма в C#


ThreadPool - это инструмент .NET, которому задаются определенные потоки и выдает их на выполнение при надобности. 

## Зачем нам нужен ThreadPool ?

Со `Thread` мы столкнулись с проблемой, что создание потока занимает много времени и ресурсов.
Но это еще пол беды. Самая основная проблема заключается в том, что после создания потока мы не можем переиспользовать его.

То есть такой код не будет работать так как вы думаете:

```csharp

Thread th1 = new(() => { Console.WriteLine("Hello"); });

th1.Start();

th1 = new(() => { Console.WriteLine("World"); });

th1.Start();

```

После первого раза он заного создаст поток и выполнит его, что очень сильно ухудшает производительность.

## Как работает ThreadPool ?

После запуска вашей программы уже есть определенное количество потоков в пуле.

`Pool` - это место, где хранятся потоки, которые могут быть использованы для выполнения задач.
Можете ассоциировать его с бассейном, где хранятся потоки.

Интересный момент заключается в том, что если потоки в пуле заняты, то `CLR` выделит вам новый поток.    

Только что созданный поток живет 40 секунд после остановки, а потом операционная система видит, что он не используется и убивает его.

## Как использовать ThreadPool ?

```csharp

ThreadPool.QueueUserWorkItem((s) => { Console.WriteLine("Hello"); });

```

## Новая параллельная тема урока
- CountDownEvent
- AutoResetEvent
- ManualResetEvent


Мы уже с вами прошли lock, Mutex, Semaphore. Вы должны понимать разницу между инструментами синхронизации потоков и счетчиками.


Многие люди путают `CountDownEvent`, `AutoResetEvent`, `ManualResetEvent` с `Semaphore` и `Mutex`.

Вот несколько причин почему они разные:
1. `Semaphore` и `Mutex` - это инструменты синхронизации потоков, а `CountDownEvent`, `AutoResetEvent`, `ManualResetEvent` - это счетчики.
2. `Semaphore` и `Mutex` - это инструменты для  синхронизации потоков, а `CountDownEvent`, `AutoResetEvent`, `ManualResetEvent` - это инструменты для ограничения доступа к ресурсам.

